<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>FinanÃ§a Animal</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{font-family:Arial;margin:0;background:url('https://images.unsplash.com/photo-1517849845537-4d257902454a')center/cover fixed;}
header{background:#4e342e;color:white;text-align:center;padding:15px;font-size:22px;}
.container{max-width:900px;margin:auto;padding:15px;}
.box{background:white;border-radius:15px;padding:15px;margin-bottom:20px;box-shadow:0 4px 10px rgba(0,0,0,0.2);}
input,textarea,button{width:100%;padding:8px;margin-top:6px;border-radius:8px;border:1px solid #ccc;}
button{background:#6d4c41;color:white;font-weight:bold;border:none;cursor:pointer;}
canvas{max-width:300px;margin:auto;display:block}

/* DICAS */
.tip-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;}
.tip-card{perspective:1000px;height:100px;}
.tip-inner{position:relative;width:100%;height:100%;transition:transform 0.6s;transform-style:preserve-3d;}
.tip-card:hover .tip-inner{transform:rotateY(180deg);}
.tip-front,.tip-back{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:10px;display:flex;align-items:center;justify-content:center;text-align:center;padding:5px;}
.tip-front{background:#ffca28;}
.tip-back{background:#6d4c41;color:white;transform:rotateY(180deg);}

/* POSTS */
.post img{width:100%;border-radius:10px;margin-top:5px}
.actions{display:flex;gap:10px;margin-top:5px}
.comment{background:#f1f1f1;margin-top:5px;padding:5px;border-radius:5px}
video{width:100%;border-radius:10px;margin-top:10px}
</style>
</head>

<body>
<header>ğŸ¾ FinanÃ§a Animal</header>
<div class="container">

<!-- CALCULADORA -->
<div class="box">
<h3>ğŸ’° Planejamento do Pet</h3>
<input id="food" type="number" placeholder="AlimentaÃ§Ã£o">
<input id="health" type="number" placeholder="SaÃºde">
<input id="extras" type="number" placeholder="Mimos">
<button onclick="calc()">Analisar Gastos</button>
<p id="alert"></p>
<canvas id="chart"></canvas>
</div>

<!-- DICAS -->
<div class="box">
<h3>ğŸ’¡ Dicas <button onclick="updateTips()">Atualizar</button></h3>
<div class="tip-grid" id="tips"></div>
</div>

<!-- HISTÃ“RIA PET -->
<div class="box">
<h3>ğŸ“– HistÃ³ria do seu Pet</h3>
<input id="petName" placeholder="Nome do Pet">
<textarea id="story" placeholder="Conte a histÃ³ria"></textarea>
<input type="file" id="photos" multiple>
<button onclick="postStory()">Publicar HistÃ³ria</button>
<div id="stories"></div>
</div>

<!-- MOMENTO FOFURA -->
<div class="box">
<h3>ğŸ“¸ Momento Fofura</h3>
<input type="file" id="cuteUpload">
<button onclick="addCute()">Adicionar Foto Fofa</button>
<div id="cute"></div>
</div>

<!-- VÃDEOS -->
<div class="box">
<h3>ğŸ¥ VÃ­deos EngraÃ§ados de Pets</h3>
<input type="file" id="videoUpload" accept="video/*">
<button onclick="addVideo()">Adicionar VÃ­deo</button>
<div id="videos"></div>
</div>

</div>

<script>
// CALCULADORA
let chart;
function calc(){
let f=+food.value||0,h=+health.value||0,e=+extras.value||0,total=f+h+e;
alert.innerText=total>500?"âš  Gastando muito!":"âœ… Gastos sob controle!";
if(chart)chart.destroy();
chart=new Chart(chartEl=document.getElementById("chart"),{
type:'doughnut',
data:{labels:["AlimentaÃ§Ã£o","SaÃºde","Mimos"],datasets:[{data:[f,h,e]}]}
});
}

// DICAS
const tipList=["Vacinas evitam gastos grandes","RaÃ§Ã£o boa reduz veterinÃ¡rio","Escovar dentes evita cirurgia","Passeio mantÃ©m saÃºde","HidrataÃ§Ã£o Ã© essencial","Brincar reduz ansiedade"];
function updateTips(){
tips.innerHTML="";
tipList.sort(()=>0.5-Math.random()).slice(0,4).forEach(t=>{
tips.innerHTML+=`<div class="tip-card"><div class="tip-inner">
<div class="tip-front">ğŸ¶ Dica</div>
<div class="tip-back">${t}</div>
</div></div>`;
});
}
updateTips();

/* ================= HISTÃ“RIAS COMPLETAS ================= */

let stories = JSON.parse(localStorage.getItem("petStories")) || [];

function saveStories(){
  localStorage.setItem("petStories", JSON.stringify(stories));
}

function postStory(){
  let name = petName.value;
  let text = story.value;
  let file = photos.files[0];

  if(!name || !text) return alert("Preencha nome e histÃ³ria");

  const reader = new FileReader();
  reader.onload = function(e){
    stories.push({
      id: Date.now(),
      name,
      text,
      img: e.target.result || "",
      likes: 0,
      comments: []
    });
    saveStories();
    renderStories();
  };

  if(file) reader.readAsDataURL(file);
  else reader.onload({target:{result:""}});
}

function renderStories(){
  storiesDiv.innerHTML = "";
  stories.forEach(s=>{
    storiesDiv.innerHTML += `
      <div class="box post">
        <h4>${s.name}</h4>
        <p>${s.text}</p>
        ${s.img ? `<img src="${s.img}">` : ""}

        <div class="actions">
          <button onclick="likeStory(${s.id})">â¤ï¸ ${s.likes}</button>
          <button onclick="editStory(${s.id})">âœï¸ Editar</button>
          <button onclick="deleteStory(${s.id})">ğŸ—‘ï¸ Excluir</button>
        </div>

        <input id="c${s.id}" placeholder="Escrever comentÃ¡rio">
        <button onclick="addComment(${s.id})">Comentar</button>

        ${s.comments.map(c=>`<div class="comment">${c}</div>`).join("")}
      </div>
    `;
  });
}

function likeStory(id){
  stories.find(s=>s.id==id).likes++;
  saveStories();
  renderStories();
}

function deleteStory(id){
  stories = stories.filter(s=>s.id!=id);
  saveStories();
  renderStories();
}

function editStory(id){
  let s = stories.find(s=>s.id==id);
  let novo = prompt("Editar histÃ³ria:", s.text);
  if(novo){
    s.text = novo;
    saveStories();
    renderStories();
  }
}

function addComment(id){
  let input = document.getElementById("c"+id);
  if(!input.value) return;
  stories.find(s=>s.id==id).comments.push(input.value);
  input.value = "";
  saveStories();
  renderStories();
}

const storiesDiv = document.getElementById("stories");
renderStories();
}

// MOMENTO FOFURA
const cuteImgs=["https://images.unsplash.com/photo-1548199973-03cce0bbc87b","https://images.unsplash.com/photo-1518717758536-85ae29035b6d"];
cuteImgs.forEach(src=>cute.innerHTML+=`<img src="${src}" style="width:100%;margin-top:10px;border-radius:10px">`);

function addCute(){
let f=cuteUpload.files[0];if(!f)return;
let r=new FileReader();r.onload=e=>cute.innerHTML+=`<img src="${e.target.result}" style="width:100%;margin-top:10px;border-radius:10px">`;
r.readAsDataURL(f);
}

// VÃDEOS
function addVideo(){
let f=videoUpload.files[0];if(!f)return;
let r=new FileReader();
r.onload=e=>videos.innerHTML+=`<video src="${e.target.result}" controls loop></video>`;
r.readAsDataURL(f);
}
</script>
</body>
</html>

