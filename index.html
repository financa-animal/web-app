<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finan√ßa Animal | Dashboard</title>
<script src="https://www.gstatic.com/charts/loader.js"></script>

<style>
:root { --bg-body:#fdfbf7; --white:#fff; --accent-gold:#c68642; --earth-brown:#3e2723; }
body { font-family:'Segoe UI'; background:var(--bg-body); margin:0; padding-bottom:50px;}

.hero { height:35vh; background:linear-gradient(rgba(0,0,0,.3),rgba(0,0,0,.4)),url('https://images.unsplash.com/photo-1519098901909-b1553a1190af?q=80&w=2000'); background-size:cover; display:flex; align-items:center; justify-content:center; color:white; border-bottom:6px solid var(--accent-gold);}
.hero h1{font-size:3rem}

.dashboard{max-width:1200px;margin:-40px auto 20px;display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:20px;padding:0 20px;}
.dash-card{background:var(--white);border-radius:12px;padding:25px;box-shadow:0 10px 30px rgba(0,0,0,0.08);border-top:5px solid var(--accent-gold);}
.dash-card h2{margin-top:0;color:var(--earth-brown)}

.galeria-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:15px;}
.galeria-grid img{width:100%;height:75px;object-fit:cover;border-radius:6px;}

.mural-input{grid-column:1/-1;background:white;padding:30px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.08);}
.mural-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:20px;margin-top:25px}
.pet-post{background:#fdfbf7;border:1px solid #eee;padding:15px;border-radius:10px;text-align:center;position:relative;}
.pet-post img,.pet-post iframe{width:100%;height:150px;object-fit:cover;border-radius:8px;margin-bottom:10px;}
.btn-delete{position:absolute;top:5px;right:5px;background:#d32f2f;color:white;border:none;border-radius:50%;width:25px;height:25px;cursor:pointer;}

input,textarea{width:100%;padding:12px;margin-bottom:10px;border:1px solid #eee;border-radius:6px;background:#fafafa}
button{background:var(--accent-gold);color:white;border:none;padding:12px;width:100%;border-radius:6px;font-weight:bold;cursor:pointer}
button:hover{background:var(--earth-brown)}
</style>
</head>
<body>

<header class="hero"><h1>FINAN√áA ANIMAL</h1></header>

<div class="dashboard">

<section class="dash-card">
<h2>üí∞ Planejamento</h2>
<input type="number" id="ali" placeholder="Alimenta√ß√£o (Mensal)">
<input type="number" id="sau" placeholder="Sa√∫de (Mensal)">
<input type="number" id="mim" placeholder="Mimos (Mensal)">
<button onclick="calcularTudo()">ANALISAR GASTOS</button>
<div id="chart_div" style="height:140px;margin-top:10px;"></div>
<p style="font-size:.8rem;color:#d32f2f;font-weight:bold;text-align:center;margin-top:10px;">üõ°Ô∏è Emerg√™ncia: <span id="reserva">R$ 0,00</span></p>
</section>

<section class="dash-card">
<h2>üì∏ Momento Fofura</h2>
<div class="galeria-grid" id="galeriaFotos"></div>
<button onclick="carregarFotos()" style="margin-top:12px;background:none;color:var(--accent-gold);border:1px solid var(--accent-gold);font-size:.8rem;">üîÑ NOVAS FOTOS</button>
</section>

<section class="mural-input">
<h2 style="text-align:center;">üìñ Registre a hist√≥ria do seu Pet</h2>
<input type="text" id="nomePet" placeholder="Nome do Pet">
<textarea id="relato" placeholder="Como voc√™s se conheceram?"></textarea>
<input type="file" id="fotoPet" accept="image/*">
<input type="text" id="linkVideo" placeholder="Ou cole link de v√≠deo (YouTube)">
<button onclick="salvarMural()">REGISTRAR NO MURAL üêæ</button>
<div id="muralGrid" class="mural-grid"></div>
</section>

</div>

<script>
google.charts.load('current', {'packages':['corechart']});

const listaImagens=[
"https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?w=150",
"https://images.unsplash.com/photo-1583511655857-d19b40a7a54e?w=150",
"https://images.unsplash.com/photo-1543466835-00a7907e9de1?w=150",
"https://images.unsplash.com/photo-1552053831-71594a27632d?w=150",
"https://images.unsplash.com/photo-1537151608828-ea2b11777ee8?w=150",
"https://images.unsplash.com/photo-1517423440428-a5a00ad1e3e8?w=150",
"https://images.unsplash.com/photo-1548191265-cc70d3d45ba1?w=150",
"https://images.unsplash.com/photo-1601758125946-6ec2ef64daf8?w=150",
"https://images.unsplash.com/photo-1598137261035-9d8e8b9b56e1?w=150",
"https://images.unsplash.com/photo-1573865526739-10659fec78a5?w=150"
];

function carregarFotos(){
const grid=galeriaFotos;grid.innerHTML="";
[...listaImagens].sort(()=>0.5-Math.random()).forEach(url=>{
const img=document.createElement("img");img.src=url;grid.appendChild(img);
});
}

function calcularTudo(){
const sau=parseFloat(sau.value)||0;
reserva.innerText=`R$ ${(sau*6).toFixed(2)}`;
const data=google.visualization.arrayToDataTable([
['Gasto','R$'],
['Comida',parseFloat(ali.value)||0],
['Sa√∫de',sau],
['Mimos',parseFloat(mim.value)||0]
]);
new google.visualization.PieChart(chart_div).draw(data,{pieHole:.4,colors:['#3e2723','#c68642','#d2b48c'],chartArea:{width:'100%',height:'100%'},legend:'none'});
}

// ===== MURAL =====
let muralPosts=JSON.parse(localStorage.getItem("muralPosts"))||[];

function salvarStorage(){localStorage.setItem("muralPosts",JSON.stringify(muralPosts));}

function converterParaEmbed(link){
if(link.includes("watch?v=")){return "https://www.youtube.com/embed/"+link.split("v=")[1].split("&")[0];}
if(link.includes("youtu.be/")){return "https://www.youtube.com/embed/"+link.split("youtu.be/")[1];}
return link;
}

function renderizarMural(){
muralGrid.innerHTML="";
muralPosts.slice().reverse().forEach(p=>{
const div=document.createElement("div");div.className="pet-post";
div.innerHTML=`
<button class="btn-delete" onclick="apagarPost(${p.id})">X</button>
${p.tipo=="imagem"?`<img src="${p.src}">`:`<iframe src="${p.src}" frameborder="0" allowfullscreen></iframe>`}
<strong>${p.nome}</strong>
<p style="font-size:.8rem">${p.relato}</p>`;
muralGrid.appendChild(div);
});
}

function salvarMural(){
const nome=nomePet.value;const relatoTxt=relato.value;const foto=fotoPet.files[0];const video=linkVideo.value;
if(!nome||!relatoTxt)return alert("Preencha nome e hist√≥ria!");

if(video){
muralPosts.push({id:Date.now(),tipo:"video",src:converterParaEmbed(video),nome,relato:relatoTxt});
salvarStorage();renderizarMural();limpar();return;
}

if(foto){
const reader=new FileReader();
reader.onload=e=>{
muralPosts.push({id:Date.now(),tipo:"imagem",src:e.target.result,nome,relato:relatoTxt});
salvarStorage();renderizarMural();limpar();
};
reader.readAsDataURL(foto);
}
}

function apagarPost(id){
if(confirm("Deseja apagar?")){
muralPosts=muralPosts.filter(p=>p.id!==id);
salvarStorage();renderizarMural();
}
}

function limpar(){nomePet.value="";relato.value="";fotoPet.value="";linkVideo.value="";}

window.onload=()=>{carregarFotos();renderizarMural();}
</script>

</body>
</html>
