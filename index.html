<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Finan√ßa Animal</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:#f5f2ed;
}

h1{
  text-align:center;
  color:white;
  padding:20px;
  background:url('https://images.unsplash.com/photo-1558788353-f76d92427f16') center/cover;
  margin:0;
}

.container{
  display:flex;
  gap:20px;
  padding:20px;
}

.card{
  background:white;
  padding:15px;
  border-radius:10px;
  box-shadow:0 4px 8px rgba(0,0,0,0.1);
  flex:1;
}

button{
  background:#c68a3c;
  border:none;
  color:white;
  padding:10px;
  border-radius:6px;
  cursor:pointer;
}

input, textarea{
  width:100%;
  padding:8px;
  margin:6px 0;
}

.galeria{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}

.post{
  background:#fff;
  border-radius:10px;
  padding:8px;
  box-shadow:0 3px 6px rgba(0,0,0,0.1);
}

.post img, .post video{
  width:100%;
  border-radius:10px;
}

.like{
  color:red;
  cursor:pointer;
  font-size:14px;
}

/* TIKTOK FEED */
.tiktok-feed{
  height:420px;
  overflow-y:auto;
  scroll-snap-type:y mandatory;
}

.tiktok-video{
  scroll-snap-align:start;
  height:420px;
  margin-bottom:10px;
  border-radius:10px;
  overflow:hidden;
}

.tiktok-video iframe{
  width:100%;
  height:100%;
  border:none;
}

#historias .post{
  margin-top:10px;
}
</style>
</head>
<body>

<h1>FINAN√áA ANIMAL</h1>

<div class="container">

  <!-- PLANEJAMENTO -->
  <div class="card">
    <h3>üí∞ Planejamento</h3>
    <input type="number" id="alimentacao" placeholder="Alimenta√ß√£o">
    <input type="number" id="saude" placeholder="Sa√∫de">
    <input type="number" id="mimos" placeholder="Mimos">
    <button onclick="calcular()">ANALISAR GASTOS</button>
    <canvas id="grafico"></canvas>
    <p style="color:red;">Emerg√™ncia: R$ <span id="emergencia">0</span></p>
  </div>

  <!-- DICAS -->
  <div class="card">
    <h3>üí° Dicas</h3>
    <div id="dicas"></div>
    <button onclick="sortearDica()">Atualizar</button>
  </div>

  <!-- MOMENTO FOFURA -->
  <div class="card">
    <h3>üì∏ Momento Fofura</h3>
    <div class="galeria" id="galeriaFotos"></div>
    <div class="tiktok-feed" id="feedVideos"></div>
  </div>

</div>

<!-- HIST√ìRIA DO PET -->
<div class="card" style="margin:20px;">
  <h3>üìñ Hist√≥ria do seu Pet</h3>
  <input type="text" id="nomePet" placeholder="Nome do Pet">
  <textarea id="historiaPet" placeholder="Conte a hist√≥ria..."></textarea>
  <input type="file" id="fotoPet">
  <button onclick="publicarHistoria()">PUBLICAR</button>
  <div id="historias"></div>
</div>

<script>
let grafico;

function calcular(){
  const a = +alimentacao.value;
  const s = +saude.value;
  const m = +mimos.value;
  const total = a+s+m;
  emergencia.textContent = (total*0.2).toFixed(2);

  if(grafico) grafico.destroy();

  grafico = new Chart(graficoCanvas=document.getElementById('grafico'), {
    type:'doughnut',
    data:{
      labels:['Alimenta√ß√£o','Sa√∫de','Mimos'],
      datasets:[{data:[a,s,m]}]
    }
  });
}

/* DICAS */
const dicasLista=[
"Vacina√ß√£o em dia evita gastos futuros.",
"Escovar os dentes do pet reduz problemas.",
"Guardar 20% para emerg√™ncias √© essencial.",
"Passeios di√°rios melhoram a sa√∫de."
];

function sortearDica(){
  dicas.innerHTML="";
  dicasLista.sort(()=>0.5-Math.random()).slice(0,2).forEach(d=>{
    dicas.innerHTML+=`<p>${d}</p>`;
  });
}

/* FOTOS */
const fotos=[
"https://images.unsplash.com/photo-1517849845537-4d257902454a",
"https://images.unsplash.com/photo-1543466835-00a7907e9de1",
"https://images.unsplash.com/photo-1558788353-f76d92427f16",
"https://images.unsplash.com/photo-1583511655826-05700442b31b"
];

function criarPost(conteudo){
  const post=document.createElement("div");
  post.className="post";
  post.innerHTML=conteudo+`
  <div>
    <span class="like" onclick="curtir(this)">‚ù§ 0</span>
    <input placeholder="Comentar..." onkeydown="comentario(event,this)">
  </div>`;
  galeriaFotos.appendChild(post);
}

function curtir(el){
  let n=parseInt(el.textContent.split(" ")[1]);
  el.textContent="‚ù§ "+(++n);
}

function comentario(e,input){
  if(e.key==="Enter"){
    input.insertAdjacentHTML("beforebegin",`<p>üí¨ ${input.value}</p>`);
    input.value="";
  }
}

/* VIDEOS TIKTOK */
const videos=[
"https://www.youtube.com/embed/tntOCGkgt98",
"https://www.youtube.com/embed/5dsGWM5XGdg",
"https://www.youtube.com/embed/9No-FiEInLA"
];

function carregarVideos(){
  videos.forEach(v=>{
    feedVideos.innerHTML+=`<div class="tiktok-video">
    <iframe src="${v}" allowfullscreen></iframe>
    </div>`;
  });
}

/* HIST√ìRIAS */
function publicarHistoria(){
  const nome=nomePet.value;
  const texto=historiaPet.value;
  const file=fotoPet.files[0];
  const reader=new FileReader();

  reader.onload=function(){
    const post=document.createElement("div");
    post.className="post";
    post.innerHTML=`
      <h4>${nome}</h4>
      <img src="${reader.result}">
      <p>${texto}</p>
      <span class="like" onclick="curtir(this)">‚ù§ 0</span>
      <input placeholder="Comentar..." onkeydown="comentario(event,this)">
    `;
    historias.prepend(post);
  }
  if(file) reader.readAsDataURL(file);
}

window.onload=()=>{
  sortearDica();
  fotos.forEach(f=>criarPost(`<img src="${f}">`));
  carregarVideos();
}
</script>

</body>
</html>
