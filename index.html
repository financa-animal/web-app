<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FinanÃ§a Animal PRO+</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{margin:0;font-family:Arial;background:#f4f4f4}
header{background:#2c1b10;color:#fff;text-align:center;padding:10px;font-size:22px}
.box{background:#fff;padding:15px;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,.1);margin:10px}
.container{display:flex;flex-wrap:wrap;gap:10px;padding:10px}
input,textarea{width:100%;padding:6px;margin:5px 0}
button{background:#6b4c2a;color:white;border:none;padding:8px;border-radius:6px;cursor:pointer}
.gallery{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
.post img{width:100%;border-radius:8px;max-height:130px;object-fit:cover}
.tip-card{background:#3d2b1f;color:white;padding:10px;border-radius:8px;text-align:center;cursor:pointer}
.ranking{font-size:14px}
.meta-bar{height:10px;background:#ddd;border-radius:10px;overflow:hidden}
.meta-fill{height:10px;background:#27ae60}
</style>
</head>
<body>

<header>ğŸ¶ FINANÃ‡A ANIMAL PRO+</header>

<div class="box">
<h3>ğŸ” Login</h3>
<input id="user" placeholder="Nome">
<input id="pass" type="password" placeholder="Senha">
<button onclick="login()">Entrar</button>
<div id="status"></div>
</div>

<div class="container">

<div class="box">
<h3>ğŸ’° Planejamento</h3>
<input type="number" id="alimentacao" placeholder="AlimentaÃ§Ã£o">
<input type="number" id="saude" placeholder="SaÃºde">
<input type="number" id="mimos" placeholder="Mimos">
<input type="number" id="meta" placeholder="Meta mensal">
<button onclick="calcular()">Calcular</button>
<canvas id="grafico"></canvas>
<div id="emergencia"></div>
<div class="meta-bar"><div id="metaFill" class="meta-fill"></div></div>
</div>

<div class="box">
<h3>ğŸ’¡ Dicas</h3>
<div id="tips"></div>
</div>

<div class="box">
<h3>ğŸ“¸ Momento Fofura</h3>
<input type="file" id="foto">
<button onclick="postFofura()">Postar</button>
<div class="gallery" id="gallery"></div>
</div>

<div class="box ranking">
<h3>ğŸ† Ranking de Pets</h3>
<div id="ranking"></div>
</div>

</div>

<div class="box">
<h3>ğŸ“– HistÃ³ria do Pet</h3>
<input id="petname" placeholder="Nome do Pet">
<textarea id="petstory"></textarea>
<input type="file" id="petphoto">
<button onclick="postStory()">Publicar HistÃ³ria</button>
<div id="stories"></div>
</div>

<script>
let currentUser=null, chart;

/* LOGIN */
function login(){
    let u=user.value,p=pass.value;
    if(!u||!p) return alert("Preencha tudo");
    let users=JSON.parse(localStorage.getItem("users")||"{}");
    if(!users[u]) users[u]=p;
    if(users[u]!==p) return alert("Senha errada");
    localStorage.setItem("users",JSON.stringify(users));
    currentUser=u;
    status.innerText="Logado como "+u;
}

/* CALCULADORA + META */
function calcular(){
let a=+alimentacao.value||0,s=+saude.value||0,m=+mimos.value||0,total=a+s+m;
emergencia.innerText="Reserva emergÃªncia: R$ "+(total*0.2).toFixed(2);
let metaVal=+meta.value||1;
metaFill.style.width=Math.min((total/metaVal)*100,100)+"%";
if(chart) chart.destroy();
chart=new Chart(grafico,{type:'doughnut',data:{labels:['AlimentaÃ§Ã£o','SaÃºde','Mimos'],datasets:[{data:[a,s,m]}]}});
}

/* DICAS AUTOMÃTICAS */
const tipsArr=["Guarde 20%","Vacinas evitam custos","Passeio Ã© saÃºde","Boa raÃ§Ã£o economiza","Ãgua limpa sempre"];
tips.innerHTML=tipsArr.map(t=>`<div class='tip-card'>${t}</div>`).join("");

/* FOFOURA */
function postFofura(){
if(!currentUser) return alert("FaÃ§a login!");
let f=foto.files[0]; if(!f) return;
let r=new FileReader();
r.onload=e=>{
let posts=JSON.parse(localStorage.getItem("posts")||"[]");
posts.push({user:currentUser,img:e.target.result,likes:0,comments:[]});
localStorage.setItem("posts",JSON.stringify(posts));
loadPosts();
};
r.readAsDataURL(f);
}

function loadPosts(){
let posts=JSON.parse(localStorage.getItem("posts")||"[]");
gallery.innerHTML="";
let petLikes={};
posts.forEach((p,i)=>{
petLikes[p.user]=(petLikes[p.user]||0)+p.likes;
gallery.innerHTML+=`
<div class="post">
<img src="${p.img}">
<b>${p.user}</b><br>
â¤ï¸ <span onclick="like(${i})">${p.likes}</span>
<div>${p.comments.join("<br>")}</div>
<input placeholder="Comentar" onblur="comment(this,${i})">
</div>`;
});
let rank=Object.entries(petLikes).sort((a,b)=>b[1]-a[1]);
ranking.innerHTML=rank.map(r=>`${r[0]} - ${r[1]} â¤ï¸`).join("<br>");
}
function like(i){
let posts=JSON.parse(localStorage.getItem("posts"));
posts[i].likes++;
localStorage.setItem("posts",JSON.stringify(posts));
loadPosts();
}
function comment(el,i){
if(!el.value) return;
let posts=JSON.parse(localStorage.getItem("posts"));
posts[i].comments.push(currentUser+": "+el.value);
localStorage.setItem("posts",JSON.stringify(posts));
loadPosts();
}
loadPosts();

/* HISTÃ“RIAS */
function postStory(){
if(!currentUser) return alert("FaÃ§a login!");
let f=petphoto.files[0]; if(!f) return;
let r=new FileReader();
r.onload=e=>{
let stories=JSON.parse(localStorage.getItem("stories")||"[]");
stories.push({user:currentUser,pet:petname.value,text:petstory.value,img:e.target.result});
localStorage.setItem("stories",JSON.stringify(stories));
loadStories();
};
r.readAsDataURL(f);
}
function loadStories(){
let stories=JSON.parse(localStorage.getItem("stories")||"[]");
stories.innerHTML="";
stories.forEach(s=>{
stories.innerHTML+=`<div class="post"><b>${s.user}</b> - ${s.pet}<br><img src="${s.img}"><p>${s.text}</p></div>`;
});
}
loadStories();
</script>
</body>
</html>
