<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FofoPet ğŸ¾</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{margin:0;font-family:Poppins;background:#fff8f2;color:#333}
header{background:linear-gradient(90deg,#ffb6b9,#fae3d9);padding:15px;text-align:center;font-size:22px;font-weight:700}
.container{padding:15px;max-width:700px;margin:auto}
.card{background:white;border-radius:16px;padding:12px;margin-bottom:15px;box-shadow:0 4px 10px rgba(0,0,0,0.08)}
textarea,input{width:100%;padding:8px;margin-top:6px;border-radius:8px;border:1px solid #ddd}
button{background:#ff8fab;border:none;padding:8px 14px;border-radius:20px;color:white;margin-top:8px;cursor:pointer}
.post-img{width:100%;border-radius:12px;margin-top:8px}
.like{color:#ff477e;font-weight:bold;cursor:pointer}
.small{font-size:12px;color:#666}
.flip-card{perspective:1000px}
.flip-inner{transition:transform .6s;transform-style:preserve-3d}
.flip-card:hover .flip-inner{transform:rotateY(180deg)}
.flip-front,.flip-back{backface-visibility:hidden;position:absolute;width:100%;height:100%;border-radius:16px;padding:15px}
.flip-front{background:#ffe5ec}
.flip-back{background:#ffc2d1;transform:rotateY(180deg)}
.chat-box{height:200px;overflow-y:auto;background:#fff;border-radius:10px;padding:8px;margin-bottom:8px}
</style>
</head>

<body>
<header>ğŸ¶ FofoPet</header>
<div class="container">

<!-- HISTÃ“RIA PET -->
<div class="card">
<h3>HistÃ³ria do seu pet</h3>
<input id="name" placeholder="Nome do pet">
<textarea id="story" placeholder="Conte a histÃ³ria"></textarea>
<input id="image" placeholder="Link da foto">
<button onclick="addPost()">Postar</button>
</div>

<div id="posts"></div>

<!-- CHAT -->
<div class="card">
<h3>Chat Fofo ğŸ’¬</h3>
<div class="chat-box" id="chat"></div>
<input id="msg" placeholder="Digite..." onkeypress="if(event.key==='Enter')sendMsg()">
<button onclick="sendMsg()">Enviar</button>
</div>

<!-- CALCULADORA -->
<div class="card">
<h3>Calculadora de Gastos</h3>
<input id="food" placeholder="RaÃ§Ã£o">
<input id="vet" placeholder="VeterinÃ¡rio">
<input id="toy" placeholder="Brinquedos">
<button onclick="calc()">Calcular</button>
<canvas id="grafico"></canvas>
<button onclick="gerarPDF()">Salvar em PDF</button>
</div>

<!-- DICAS -->
<div class="card">
<h3>Dicas para seu pet</h3>
<div style="display:flex;gap:10px;flex-wrap:wrap">
<div class="flip-card" style="width:48%;height:120px;position:relative">
<div class="flip-inner">
<div class="flip-front">ğŸ¥• AlimentaÃ§Ã£o</div>
<div class="flip-back">Evite doces e dÃª raÃ§Ã£o de qualidade.</div>
</div></div>

<div class="flip-card" style="width:48%;height:120px;position:relative">
<div class="flip-inner">
<div class="flip-front">ğŸƒ ExercÃ­cios</div>
<div class="flip-back">Passeios diÃ¡rios fazem bem!</div>
</div></div>
</div>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, updateDoc, doc, arrayUnion } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
 apiKey:"AIzaSyCtwYxRgTmrTyjqHGX6P0VPYER",
 authDomain:"financa-animal.firebaseapp.com",
 projectId:"financa-animal"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const banned=["sexo","porn","morte","matar","violencia","idiota","burro"];

window.addPost=async()=>{
 const name=name.value;const story=story.value;const image=image.value;
 if(banned.some(w=>story.toLowerCase().includes(w)))return alert("Texto bloqueado");
 await addDoc(collection(db,"posts"),{name,story,image,likes:0,comments:[]});
}

onSnapshot(collection(db,"posts"),snap=>{
 posts.innerHTML="";
 snap.forEach(d=>{
  const p=d.data();
  posts.innerHTML+=`<div class="card"><b>${p.name}</b><p>${p.story}</p>
  ${p.image?`<img src="${p.image}" class="post-img">`:""}
  <div class="like" onclick="likePost('${d.id}')">â¤ï¸ ${p.likes}</div>
  <input placeholder="Comentar" onkeypress="if(event.key==='Enter')comment('${d.id}',this.value)">
  ${p.comments.map(c=>`<div class="small">ğŸ’¬ ${c}</div>`).join("")}</div>`;
 })
})

window.likePost=async(id)=>{
 const r=doc(db,"posts",id);
 const s=await getDoc(r);
 await updateDoc(r,{likes:s.data().likes+1});
}

window.comment=async(id,t)=>{
 if(banned.some(w=>t.toLowerCase().includes(w)))return alert("ComentÃ¡rio bloqueado");
 await updateDoc(doc(db,"posts",id),{comments:arrayUnion(t)});
}

window.sendMsg=async()=>{
 const text=msg.value;
 if(banned.some(w=>text.toLowerCase().includes(w)))return;
 await addDoc(collection(db,"chat"),{text});
 msg.value="";
}

onSnapshot(collection(db,"chat"),s=>{
 chat.innerHTML="";
 s.forEach(d=>chat.innerHTML+=`<div>ğŸ’¬ ${d.data().text}</div>`);
})

// CALCULADORA
window.calc=()=>{
 let f=+food.value,v=+vet.value,t=+toy.value;
 const ctx=document.getElementById("grafico");
 new Chart(ctx,{type:'bar',data:{labels:['RaÃ§Ã£o','Vet','Brinq'],datasets:[{data:[f,v,t]}]}});
 if(f+v+t>500)alert("Gastos altos este mÃªs!");
}

window.gerarPDF=()=>{
 const {jsPDF}=window.jspdf;
 const doc=new jsPDF();
 doc.text("Gastos do Pet",10,10);
 doc.save("gastos.pdf");
}
</script>
</body>
</html>
