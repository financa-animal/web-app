<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üêæ Finan√ßa Animal</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{margin:0;font-family:Arial;background:url("https://images.unsplash.com/photo-1518717758536-85ae29035b6d") center/cover fixed;}
header{background:#4b2e1e;color:white;text-align:center;padding:15px;font-size:22px;}
.card{background:white;margin:15px auto;padding:15px;border-radius:12px;width:95%;max-width:520px;box-shadow:0 4px 12px rgba(0,0,0,0.2);}
input,textarea,button{width:100%;padding:8px;margin:6px 0;border-radius:6px;border:1px solid #ccc;}
button{background:#5a3d2b;color:white;cursor:pointer}
.post{background:#fff;padding:8px;border-radius:10px;margin-bottom:10px}
.post img{width:100%;border-radius:8px}
.actions{display:flex;gap:5px;flex-wrap:wrap;margin-top:5px}
.like{color:red;cursor:pointer}
.comment{background:#f2f2f2;padding:4px;margin-top:3px;border-radius:5px;font-size:13px}
.alert{color:green;font-weight:bold}
</style>
</head>

<body>

<header>üêæ Finan√ßa Animal</header>

<div class="card">
<h3>üë§ Seu nome</h3>
<input id="user" placeholder="Digite seu nome">
<button onclick="salvarUsuario()">Salvar Nome</button>
</div>

<div class="card">
<h3>üìñ Hist√≥ria do seu Pet</h3>
<input id="nomePet" placeholder="Nome do Pet">
<textarea id="historia" placeholder="Conte a hist√≥ria"></textarea>
<input type="file" id="foto">
<button onclick="salvarPost()">Publicar</button>
<div id="ok" class="alert"></div>
</div>

<div class="card">
<h3>üì∏ Momento Fofura</h3>
<div id="feed"></div>
</div>

<script>
let usuario = localStorage.getItem("usuario") || "";
user.value = usuario;

function salvarUsuario(){
 usuario = user.value;
 localStorage.setItem("usuario", usuario);
 alert("Nome salvo!");
}

let posts = JSON.parse(localStorage.getItem("posts")) || [];

/* Fotos fofas padr√£o */
if(posts.length===0){
 posts.push({autor:"Finan√ßa Animal",nome:"Dog Feliz",texto:"S√≥ alegria!",img:"https://images.unsplash.com/photo-1507146426996-ef05306b995a",likes:0,comentarios:[]});
 posts.push({autor:"Finan√ßa Animal",nome:"Gatinho Fofo",texto:"Olha essa carinha!",img:"https://images.unsplash.com/photo-1518020382113-a7e8fc38eac9",likes:0,comentarios:[]});
}

function salvarPost(){
 if(!usuario) return alert("Salve seu nome primeiro!");
 let file=foto.files[0];
 let reader=new FileReader();
 reader.onload=e=>{
  posts.unshift({
   autor:usuario,
   nome:nomePet.value,
   texto:historia.value,
   img:e.target.result,
   likes:0,
   comentarios:[]
  });
  localStorage.setItem("posts",JSON.stringify(posts));
  ok.innerText="Publica√ß√£o feita com sucesso!";
  renderPosts();
 };
 if(file) reader.readAsDataURL(file);
}

function renderPosts(){
 feed.innerHTML="";
 posts.forEach((p,i)=>{
  let comentariosHTML="";
  p.comentarios.forEach(c=>comentariosHTML+=`<div class="comment">${c}</div>`);

  let botoesAutor = "";
  if(p.autor===usuario){
    botoesAutor=`
      <button onclick="editar(${i})">‚úèÔ∏è</button>
      <button onclick="excluir(${i})">üóë</button>`;
  }

  feed.innerHTML+=`
  <div class="post">
   <b>${p.nome}</b> ‚Äî por ${p.autor}
   <p>${p.texto}</p>
   <img src="${p.img}">
   <div class="actions">
     <span class="like" onclick="curtir(${i})">‚ù§Ô∏è ${p.likes}</span>
     ${botoesAutor}
   </div>
   <input placeholder="Comentar..." onkeydown="if(event.key==='Enter') comentar(${i},this)">
   ${comentariosHTML}
  </div>`;
 });
}
renderPosts();

function curtir(i){
 posts[i].likes++;
 localStorage.setItem("posts",JSON.stringify(posts));
 renderPosts();
}

function comentar(i,input){
 posts[i].comentarios.push(input.value);
 localStorage.setItem("posts",JSON.stringify(posts));
 renderPosts();
}

function excluir(i){
 posts.splice(i,1);
 localStorage.setItem("posts",JSON.stringify(posts));
 renderPosts();
}

function editar(i){
 nomePet.value=posts[i].nome;
 historia.value=posts[i].texto;
 posts.splice(i,1);
 localStorage.setItem("posts",JSON.stringify(posts));
 renderPosts();
}
</script>

</body>
</html>
